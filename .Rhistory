linewidth = 0.75) +
ylab("Probability of\nvote intent (%)") +
xlab("RCI of leading party") +
scale_x_continuous(breaks = breaks_x*10) +
scale_y_continuous(expand = c(0,0),
breaks = c(1,25,50,75,99),
labels = c(0,25,50,75,100)) +
scale_alpha_continuous(range = c(0.2,1)) +
scale_color_manual(values = party_colors) +
scale_linewidth_continuous(range = c(1,1.5)) +
envalysis::theme_publish() +
theme(axis.ticks = element_blank(),
plot.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white"))
ggplot(Graph, aes(x = vote_solidity*10, y = prob_vote*100)) +
geom_line(stat = "smooth",
method = "gam",
aes(color = party,
group = party,
alpha = alpha,
linewidth = alpha),
show.legend = F) +
geom_vline(xintercept = 0, linewidth = 0.4) +
geom_segment(data = segments,
aes(x = vote_solidity,
xend = vote_solidity,
yend = gam),
y = 0,
color = "black",
linetype = "dashed",
alpha = 1,
linewidth = 0.75) +
geom_text(data = segments,
aes(x = vote_solidity,
y = gam + 2,
label = round(gam)),
size = 3) +
ylab("Probability of\nvote intent (%)") +
xlab("RCI of leading party") +
scale_x_continuous(breaks = breaks_x*10) +
scale_y_continuous(expand = c(0,0),
breaks = c(1,25,50,75,99),
labels = c(0,25,50,75,100)) +
scale_alpha_continuous(range = c(0.35,1)) +
scale_color_manual(values = party_colors) +
scale_linewidth_continuous(range = c(1,1.5)) +
envalysis::theme_publish() +
theme(axis.ticks = element_blank(),
plot.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white"))
ggplot(Graph, aes(x = vote_solidity*10, y = prob_vote*100)) +
geom_line(stat = "smooth",
method = "gam",
aes(color = party,
group = party,
alpha = alpha,
linewidth = alpha),
show.legend = F) +
geom_vline(xintercept = 0, linewidth = 0.4) +
geom_segment(data = segments,
aes(x = vote_solidity,
xend = vote_solidity,
yend = gam),
y = 0,
color = "black",
linetype = "dashed",
alpha = 1,
linewidth = 0.75) +
geom_text(data = segments,
aes(x = vote_solidity,
y = gam + 2,
label = paste0(round(gam), "%")),
size = 3) +
ylab("Probability of\nvote intent (%)") +
xlab("RCI of leading party") +
scale_x_continuous(breaks = breaks_x*10) +
scale_y_continuous(expand = c(0,0),
breaks = c(1,25,50,75,99),
labels = c(0,25,50,75,100)) +
scale_alpha_continuous(range = c(0.35,1)) +
scale_color_manual(values = party_colors) +
scale_linewidth_continuous(range = c(1,1.5)) +
envalysis::theme_publish() +
theme(axis.ticks = element_blank(),
plot.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white"))
ggsave("graphs/appendix_prob_voteInt.png",
width = 8, height = 5)
ggplot(Graph, aes(x = vote_solidity*10, y = prob_vote*100)) +
geom_line(stat = "smooth",
method = "gam",
aes(color = party,
group = party,
alpha = alpha,
linewidth = alpha),
show.legend = F) +
geom_vline(xintercept = 0, linewidth = 0.4) +
geom_segment(data = segments,
aes(x = vote_solidity,
xend = vote_solidity,
yend = gam),
y = 0,
color = "black",
linetype = "dashed",
alpha = 1,
linewidth = 0.75) +
geom_text(data = segments %>% filter(vote_solidity!=8),
aes(x = vote_solidity-0.5,
y = gam + 2,
label = paste0(round(gam), "%")),
size = 3) +
ylab("Probability of\nvote intent (%)") +
xlab("RCI of leading party") +
scale_x_continuous(breaks = breaks_x*10) +
scale_y_continuous(expand = c(0,0),
breaks = c(1,25,50,75,99),
labels = c(0,25,50,75,100)) +
scale_alpha_continuous(range = c(0.35,1)) +
scale_color_manual(values = party_colors) +
scale_linewidth_continuous(range = c(1,1.5)) +
envalysis::theme_publish() +
theme(axis.ticks = element_blank(),
plot.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white"))
ggsave("graphs/appendix_prob_voteInt.png",
width = 8, height = 4.5)
ggplot(Graph, aes(x = vote_solidity*10, y = prob_vote*100)) +
geom_line(stat = "smooth",
method = "gam",
aes(color = party,
group = party,
alpha = alpha,
linewidth = alpha),
show.legend = F) +
geom_vline(xintercept = 0, linewidth = 0.4) +
geom_segment(data = segments,
aes(x = vote_solidity,
xend = vote_solidity,
yend = gam),
y = 0,
color = "black",
linetype = "dashed",
alpha = 1,
linewidth = 0.75) +
geom_text(data = segments %>% filter(vote_solidity!=8),
aes(x = vote_solidity-0.15,
y = gam + 2,
label = paste0(round(gam), "%")),
size = 3) +
ylab("Probability of\nvote intent (%)") +
xlab("RCI of leading party") +
scale_x_continuous(breaks = breaks_x*10) +
scale_y_continuous(expand = c(0,0),
breaks = c(1,25,50,75,99),
labels = c(0,25,50,75,100)) +
scale_alpha_continuous(range = c(0.35,1)) +
scale_color_manual(values = party_colors) +
scale_linewidth_continuous(range = c(1,1.5)) +
envalysis::theme_publish() +
theme(axis.ticks = element_blank(),
plot.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white"))
ggsave("graphs/appendix_prob_voteInt.png",
width = 8, height = 4.5)
ggplot(Graph, aes(x = vote_solidity*10, y = prob_vote*100)) +
geom_line(stat = "smooth",
method = "gam",
aes(color = party,
group = party,
alpha = alpha,
linewidth = alpha),
show.legend = F) +
geom_vline(xintercept = 0, linewidth = 0.4) +
geom_segment(data = segments,
aes(x = vote_solidity,
xend = vote_solidity,
yend = gam),
y = 0,
color = "black",
linetype = "dashed",
alpha = 1,
linewidth = 0.75) +
geom_text(data = segments %>% filter(vote_solidity!=8),
aes(x = vote_solidity-0.2,
y = gam + 2,
label = paste0(round(gam), "%")),
size = 3) +
ylab("Probability of\nvote intent (%)") +
xlab("RCI of leading party") +
scale_x_continuous(breaks = breaks_x*10) +
scale_y_continuous(expand = c(0,0),
breaks = c(1,25,50,75,99),
labels = c(0,25,50,75,100)) +
scale_alpha_continuous(range = c(0.35,1)) +
scale_color_manual(values = party_colors) +
scale_linewidth_continuous(range = c(1,1.5)) +
envalysis::theme_publish() +
theme(axis.ticks = element_blank(),
plot.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white"))
ggsave("graphs/appendix_prob_voteInt.png",
width = 8, height = 4.5)
ggplot(Graph, aes(x = vote_solidity*10, y = prob_vote*100)) +
geom_line(stat = "smooth",
method = "gam",
aes(color = party,
group = party,
alpha = alpha,
linewidth = alpha),
show.legend = F) +
geom_vline(xintercept = 0, linewidth = 0.4) +
geom_segment(data = segments,
aes(x = vote_solidity,
xend = vote_solidity,
yend = gam),
y = 0,
color = "black",
linetype = "dashed",
alpha = 1,
linewidth = 0.75) +
geom_text(data = segments %>% filter(vote_solidity!=8),
aes(x = vote_solidity-0.25,
y = gam + 2,
label = paste0(round(gam), "%")),
size = 3) +
ylab("Probability of\nvote intent (%)") +
xlab("RCI of leading party") +
scale_x_continuous(breaks = breaks_x*10) +
scale_y_continuous(expand = c(0,0),
breaks = c(1,25,50,75,99),
labels = c(0,25,50,75,100)) +
scale_alpha_continuous(range = c(0.35,1)) +
scale_color_manual(values = party_colors) +
scale_linewidth_continuous(range = c(1,1.5)) +
envalysis::theme_publish() +
theme(axis.ticks = element_blank(),
plot.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white"))
ggsave("graphs/appendix_prob_voteInt.png",
width = 8, height = 4.5)
ggplot(Graph, aes(x = vote_solidity*10, y = prob_vote*100)) +
geom_line(stat = "smooth",
method = "gam",
aes(color = party,
group = party,
alpha = alpha,
linewidth = alpha),
show.legend = F) +
geom_vline(xintercept = 0, linewidth = 0.4) +
geom_segment(data = segments,
aes(x = vote_solidity,
xend = vote_solidity,
yend = gam),
y = 0,
color = "black",
linetype = "dashed",
alpha = 1,
linewidth = 0.75) +
geom_text(data = segments %>% filter(vote_solidity!=8),
aes(x = vote_solidity-0.3,
y = gam + 2,
label = paste0(round(gam), "%")),
size = 3) +
ylab("Probability of\nvote intent (%)") +
xlab("RCI of leading party") +
scale_x_continuous(breaks = breaks_x*10) +
scale_y_continuous(expand = c(0,0),
breaks = c(1,25,50,75,99),
labels = c(0,25,50,75,100)) +
scale_alpha_continuous(range = c(0.35,1)) +
scale_color_manual(values = party_colors) +
scale_linewidth_continuous(range = c(1,1.5)) +
envalysis::theme_publish() +
theme(axis.ticks = element_blank(),
plot.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white"))
ggsave("graphs/appendix_prob_voteInt.png",
width = 8, height = 4.5)
ggplot(Graph, aes(x = vote_solidity*10, y = prob_vote*100)) +
geom_line(stat = "smooth",
method = "gam",
aes(color = party,
group = party,
alpha = alpha,
linewidth = alpha),
show.legend = F) +
geom_vline(xintercept = 0, linewidth = 0.4) +
geom_segment(data = segments,
aes(x = vote_solidity,
xend = vote_solidity,
yend = gam),
y = 0,
color = "black",
linetype = "dashed",
alpha = 1,
linewidth = 0.75) +
geom_text(data = segments %>% filter(!(vote_solidity%in%c(-8,8,-5,-4))),
aes(x = vote_solidity-0.3,
y = gam + 2,
label = paste0(round(gam), "%")),
size = 3) +
ylab("Probability of\nvote intent (%)") +
xlab("RCI of leading party") +
scale_x_continuous(breaks = breaks_x*10) +
scale_y_continuous(expand = c(0,0),
breaks = c(1,25,50,75,99),
labels = c(0,25,50,75,100)) +
scale_alpha_continuous(range = c(0.35,1)) +
scale_color_manual(values = party_colors) +
scale_linewidth_continuous(range = c(1,1.5)) +
envalysis::theme_publish() +
theme(axis.ticks = element_blank(),
plot.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white"))
ggsave("graphs/appendix_prob_voteInt.png",
width = 8, height = 4.5)
ggplot(Graph, aes(x = vote_solidity*10, y = prob_vote*100)) +
geom_line(stat = "smooth",
method = "gam",
aes(color = party,
group = party,
alpha = alpha,
linewidth = alpha),
show.legend = F) +
geom_vline(xintercept = 0, linewidth = 0.4) +
geom_segment(data = segments,
aes(x = vote_solidity,
xend = vote_solidity,
yend = gam),
y = 0,
color = "black",
linetype = "dashed",
alpha = 1,
linewidth = 0.75) +
geom_text(data = segments %>% filter(!(vote_solidity%in%c(-8,8,-5,-4))),
aes(x = vote_solidity-0.35,
y = gam + 2,
label = paste0(round(gam), "%")),
size = 3) +
ylab("Probability of\nvote intent (%)") +
xlab("RCI of leading party") +
scale_x_continuous(breaks = breaks_x*10) +
scale_y_continuous(expand = c(0,0),
breaks = c(1,25,50,75,99),
labels = c(0,25,50,75,100)) +
scale_alpha_continuous(range = c(0.35,1)) +
scale_color_manual(values = party_colors) +
scale_linewidth_continuous(range = c(1,1.5)) +
envalysis::theme_publish() +
theme(axis.ticks = element_blank(),
plot.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white"))
ggsave("graphs/appendix_prob_voteInt.png",
width = 8, height = 4.5)
# Packages ----------------------------------------------------------------
library(tidyverse)
# Data -------------------------------------------------------------------
Data <- readRDS("data/table3_aggregatedData.rds")
Data <- Data %>%
mutate(
# If fragility_index is > than 0.5, fragile will
# take a value of 1. If not, it will take a value of 0.
fragile = ifelse(fragility_index >= 0.5, 1, 0),
# Same thing with campaign volatility
volatile = ifelse(volatility >= 0.5, 1, 0))
## Quick cross-tabulation to explore the data
descr::crosstab(Data$volatile, Data$fragile)
crosstab <- descr::crosstab(Data$volatile, Data$fragile,
expected=T, #Add expected frequency to each cell
prop.chisq = T, #Total contribution of each cell
chisq = T) #Results of the chi-squared test will be printed
crosstab
## Save tab into a variable to use the number of rows and columns later
tab <- crosstab$tab
# degrees of freedom: (n_rows - 1)(n_cols - 1)
dfr <- (nrow(tab)-1)*(ncol(tab)-1) ## 1 degree of freedom
# Critical value of chi-square, p=.1, df=1
cv1 <- qchisq(.1, dfr, lower.tail=F)
cv1
cv05 <- qchisq(.05, dfr, lower.tail=F)
cv05
cv01 <- qchisq(.01, dfr, lower.tail=F)
cv01
chisq.test(Data$volatile, Data$fragile)
library(tidyverse)
install.packages("kableExtra")
Data <- readRDS("data/table3_aggregatedData.rds")
View(Data)
table1 <- Data %>%
top_n(volatility, 10)
table1 <- Data %>%
top_n(x = volatility, n = 10)
?top_n
table1 <- Data %>%
top_n(x = ., n = 10, wt = volatility)
View(table1)
table1 <- Data %>%
top_n(x = ., n = 10, wt = volatility) %>%
select(riding_name, volatility)
table1 <- Data %>%
top_n(x = ., n = 10, wt = volatility) %>%
select("Riding" = riding_name, "Campaign volatility"= volatility)
table1 %>%
kbl()
library(kableExtra)
table1 %>%
kableExtra::kbl()
table1 <- Data %>%
top_n(x = ., n = 10, wt = volatility) %>%
arrange(-volatility) %>%
select("Riding" = riding_name, "Campaign volatility"= volatility)
table1 <- Data %>%
top_n(x = ., n = 10, wt = volatility) %>%
arrange(-volatility) %>%
mutate(volatility = round(volatility, 2)) %>%
select("Riding" = riding_name, "Campaign volatility"= volatility)
table1 <- Data %>%
top_n(x = ., n = 15, wt = volatility) %>%
arrange(-volatility) %>%
mutate(volatility = round(volatility, 2)) %>%
select("Riding" = riding_name, "Campaign volatility"= volatility)
table1 %>%
kableExtra::kbl()
table1 %>%
kableExtra::kbl(format = "latex")
table1 %>%
kableExtra::kbl(format = "latex") %>%
kable_minimal()
table1 %>%
kableExtra::kbl(format = "latex",
col.names = c("Riding", "Campaign volatility"),
align = "r") %>%
kable_minimal()
table1 %>%
kableExtra::kbl(format = "latex",
col.names = c("Riding", "Campaign volatility"),
align = "r")
table1 %>%
kableExtra::kbl(format = "latex",
col.names = c("Riding", "Campaign volatility"),
align = "r",
caption = "Most volatile ridings\nduring the campaign")
table1 %>%
kableExtra::kbl(format = "latex",
col.names = c("Riding", "Campaign volatility"),
align = "r",
caption = "Most volatile ridings\\during the campaign")
table1 <- Data %>%
top_n(x = ., n = 15, wt = fragility_index) %>%
arrange(-fragility_index) %>%
mutate(fragility = round(fragility, 2)) %>%
select(riding_name, fragility)
table1 <- Data %>%
top_n(x = ., n = 15, wt = fragility_index) %>%
arrange(-fragility_index) %>%
mutate(fragility = round(fragility_index, 2)) %>%
select(riding_name, fragility)
table1 %>%
kableExtra::kbl(format = "latex",
col.names = c("Riding", "Vote fragility"),
align = "r",
caption = "Most fragile ridings before the campaign")
table1 <- Data %>%
top_n(x = ., n = 15, wt = fragility_index) %>%
arrange(-fragility_index) %>%
mutate(fragility = round(fragility_index, 2)) %>%
select(riding_name, fragility)
table1 %>%
kableExtra::kbl(format = "latex",
col.names = c("Riding", "Vote fragility"),
align = "r",
caption = "Most fragile ridings before the campaign")
table2 <- Data %>%
top_n(x = ., n = 15, wt = volatility) %>%
arrange(-volatility) %>%
mutate(volatility = round(volatility, 2)) %>%
select(riding_name, volatility)
table2 %>%
kableExtra::kbl(format = "latex",
col.names = c("Riding", "Campaign volatility"),
align = "r",
caption = "Most volatile ridings during the campaign")
library(tidyverse)
# Data --------------------------------------------------------------------
Data <- readRDS("data/table3_aggregatedData.rds")
View(Data)
ggplot(Data, aes(x = fragility_index, y = fragility_index_mrp)) +
geom_jitter() +
geom_smooth()
ggplot(Data, aes(x = fragility_index, y = fragility_index_mrp)) +
geom_jitter() +
geom_smooth() +
scale_x_continuous(limits = c(0.25,0.85))
ggplot(Data, aes(x = fragility_index, y = fragility_index_mrp)) +
geom_jitter() +
geom_smooth()
cor_fragility <- cor.test(Data$fragility_index, Data$fragility_index_mrp)$estimate
ggplot(Data, aes(x = fragility_index, y = fragility_index_mrp)) +
geom_jitter(aes(color = volatility)) +
geom_smooth()
ggplot(Data, aes(x = fragility_index, y = fragility_index_mrp)) +
geom_jitter(aes(color = volatility)) +
geom_smooth() +
scale_color_gradient(low = "grey", high = "black")
ggplot(Data, aes(x = fragility_index, y = fragility_index_mrp)) +
geom_jitter(aes(color = volatility)) +
geom_smooth() +
scale_color_gradient(low = "white", high = "black")
ggplot(Data, aes(x = fragility_index, y = fragility_index_mrp)) +
geom_jitter(aes(color = volatility)) +
geom_smooth() +
scale_color_gradient(low = "lightgrey", high = "black")
