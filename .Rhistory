report = "vc*")
library(tidyverse)
install.packages("clessnverse")
install.packages("clessnverse")
devtools::install_github("clessn/clessnverse")
clessnverse::count_na(c(0.4, NA))
# Data --------------------------------------------------------------------
Volatility <- readRDS("data/table3_aggregatedData.rds") %>%
select(riding_id, volatility, fragility_index)
# Packages ----------------------------------------------------------------
library(tidyverse)
install.packages("purrr")
install.packages("purrr")
# Data --------------------------------------------------------------------
Volatility <- readRDS("data/table3_aggregatedData.rds") %>%
select(riding_id, volatility, fragility_index)
# Packages ----------------------------------------------------------------
library(tidyverse)
# Data --------------------------------------------------------------------
Volatility <- readRDS("data/table3_aggregatedData.rds") %>%
select(riding_id, volatility, fragility_index)
Data <- readRDS("mrp/data/census_data.rds") %>%
select(riding_id, starts_with("age"), french,
starts_with("income"), starts_with("educ"),
starts_with("vote2018")) %>%
left_join(Volatility, ., by = "riding_id") %>%
select(-riding_id) %>%
mutate(high_educ = educColl + educUniv,
age60p = age60m74 + age75p)
View(Data)
names(Data)
Data <- readRDS("mrp/data/census_data.rds") %>%
select(riding_id, starts_with("age"), french,
starts_with("income"), starts_with("educ"),
starts_with("vote2018")) %>%
left_join(Volatility, ., by = "riding_id") %>%
select(-riding_id) %>%
mutate(age60p = age60m74 + age75p)
Data <- readRDS("mrp/data/census_data.rds") %>%
select(riding_id, starts_with("age"), french,
starts_with("income"), starts_with("educ"),
starts_with("vote2018")) %>%
left_join(Volatility, ., by = "riding_id") %>%
select(-riding_id)
names(Data)
# Data --------------------------------------------------------------------
Volatility <- readRDS("data/table3_aggregatedData.rds") %>%
select(riding_id, volatility, fragility_index)
Data <- readRDS("mrp/data/census_data.rds") %>%
select(riding_id, starts_with("age"), french,
starts_with("income"), starts_with("educ"),
starts_with("vote2018")) %>%
left_join(Volatility, ., by = "riding_id")
names(Data)
PcaSes <- Data %>%
select(starts_with("age", "french", "income", "educ"))
PcaSes <- Data %>%
select(starts_with(c("age", "french", "income", "educ")))
View(PcaSes)
names(Data)
PcaVote <- Data %>%
select(starts_with("vote2018"))
View(PcaVote)
## Correlations between variables
cor <- cor(PcaSes)
ggcorrplot::ggcorrplot(PcaSes)
?PCA
## Generate pca
pca <- PCA(PcaSes, scale.unit = T,
ncp = 4, graph = T)
library(factoextra)
library(FactoMineR)
?PCA
## Generate pca
pca <- PCA(PcaSes, scale.unit = T, graph = T)
## eig > 1 is good
eig <- get_eigenvalue(pca)
eig
round(eig)
install.packages("plot3D")
library(plot3D)
View(Data)
## Graph
df <- data.frame(riding = Data$riding_id,
dim1 = pca$ind$coord[,1],
dim2 = pca$ind$coord[,2],
dim3 = pca$ind$coord[,3])
View(df)
## eig > 1 is good
eig <- get_eigenvalue(pca)
round(eig)
# Data --------------------------------------------------------------------
Volatility <- readRDS("data/table3_aggregatedData.rds") %>%
select(riding_id, volatility, fragility_index)
Volatility <- readRDS("data/table3_aggregatedData.rds")
View(Volatility)
# Data --------------------------------------------------------------------
Volatility <- readRDS("data/table3_aggregatedData.rds") %>%
select(riding_id, volatility, fragility_index)
Data <- readRDS("mrp/data/census_data.rds")
View(Data)
# Data --------------------------------------------------------------------
Volatility <- readRDS("data/table3_aggregatedData.rds") %>%
select(riding_id, volatility, fragility_index)
Data <- readRDS("mrp/data/census_data.rds") %>%
select(riding_id, region, female, starts_with("age"), french,
starts_with("income"), starts_with("educ"),
starts_with("vote2018")) %>%
left_join(Volatility, ., by = "riding_id")
View(Data)
PcaSes <- Data %>%
select(starts_with(c("age", "female", "french", "income", "educ")))
names(PcaSes)
PcaSes <- Data %>%
select(starts_with(c("age", "female", "french", "income", "educ")))
PcaVote <- Data %>%
select(starts_with("vote2018"))
## Correlations between variables
cor <- cor(PcaSes)
ggcorrplot::ggcorrplot(PcaSes)
## Generate pca
pca <- PCA(PcaSes, scale.unit = T, graph = T)
## eig > 1 is good
eig <- get_eigenvalue(pca)
round(eig)
ve_pc1 <- eig[1,2]
ve_pc2 <- eig[2,2]
ve_pc1
## Graph
df <- data.frame(riding = Data$riding_id,
region = Data$region,
dim1 = pca$ind$coord[,1],
dim2 = pca$ind$coord[,2],
dim3 = pca$ind$coord[,3])
scatter3D(df$dim1, df$dim2, df$dim3)
scatter3D(df$dim1, df$dim2, df$dim3, colvar = df$region)
## Graph
df <- data.frame(riding = Data$riding_id,
region = as.numeric(factor(Data$region)),
dim1 = pca$ind$coord[,1],
dim2 = pca$ind$coord[,2],
dim3 = pca$ind$coord[,3])
View(df)
scatter3D(df$dim1, df$dim2, df$dim3, colvar = df$region,
pch = 19)
facets <- df %>%
pivot_longer(starts_with("dim"))
View(facets)
View(df)
ggplot(cbind(df$dim1, df$dim2), aes(x = df$dim1, y = df$dim2)) +
geom_jitter()
ggplot(data.frame(cbind(df$dim1, df$dim2)), aes(x = df$dim1, y = df$dim2)) +
geom_jitter()
data.frame(cbind(df$dim1, df$dim2)) %>%
ggplot(aes(x = dim1, y = dim2)) +
geom_jitter()
data.frame(cbind(df$dim1, df$dim2)) %>%
ggplot(aes(x = df$dim1, y = df$dim2)) +
geom_jitter()
df %>%
ggplot(aes(x = dim1, y = dim2)) +
geom_jitter()
?scatter3D
scatter3D(df$dim1, df$dim2, df$dim3, colvar = df$region,
pch = 19, theta = T)
scatter3D(df$dim1, df$dim2, df$dim3, colvar = df$region,
pch = 19, theta = T, phi = T)
scatter3D(df$dim1, df$dim2, df$dim3, colvar = df$region,
pch = 19, theta = F, phi = T)
scatter3D(df$dim1, df$dim2, df$dim3, colvar = df$region,
pch = 19, theta = F, phi = F)
scatter3D(df$dim1, df$dim2, df$dim3, colvar = df$region,
pch = 19, theta = T, phi = F)
scatter3D(df$dim1, df$dim2, df$dim3, colvar = df$region,
pch = 19, theta = T, phi = T)
scatter3D(df$dim1, df$dim2, df$dim3, colvar = df$region,
pch = 19, theta = T, phi = F)
scatter3D(df$dim1, df$dim2, df$dim3, colvar = df$region,
pch = 19, theta = F, phi = F)
scatter3D(df$dim1, df$dim2, df$dim3, colvar = df$region,
pch = 19)
plotA <- scatter3D(df$dim1, df$dim2, df$dim3, colvar = df$region,
pch = 19)
scatter3D(df$dim1, df$dim2, df$dim3, colvar = df$region,
pch = 19)
scatter3D(df$dim1, df$dim2, df$dim3, colvar = df$region,
pch = 19, theta = F)
scatter3D(df$dim1, df$dim2, df$dim3, colvar = df$region,
pch = 19, theta = T)
scatter3D(df$dim1, df$dim2, df$dim3, colvar = df$region,
pch = 19, theta)
scatter3D(df$dim1, df$dim2, df$dim3, colvar = df$region,
pch = 19, theta = T)
scatter3D(df$dim1, df$dim2, df$dim3, colvar = df$region,
pch = 19, theta = F)
scatter3D(df$dim1, df$dim2, df$dim3, colvar = df$region,
pch = 19, phi = F)
scatter3D(df$dim1, df$dim2, df$dim3, colvar = df$region,
pch = 19, phi = T)
scatter3D(df$dim1, df$dim2, df$dim3, colvar = df$region,
pch = 19, phi = 0)
scatter3D(df$dim1, df$dim2, df$dim3, colvar = df$region,
pch = 19, phi = 90)
scatter3D(df$dim1, df$dim2, df$dim3, colvar = df$region,
pch = 19, phi = 10)
scatter3D(df$dim1, df$dim2, df$dim3, colvar = df$region,
pch = 19, phi = 0)
scatter3D(df$dim1, df$dim2, df$dim3, colvar = df$region,
pch = 19, phi = 50)
scatter3D(df$dim1, df$dim2, df$dim3, colvar = df$region,
pch = 19, phi = 30)
scatter3D(df$dim1, df$dim2, df$dim3, colvar = df$region,
pch = 19, phi = 15)
scatter3D(df$dim1, df$dim2, df$dim3, colvar = df$region,
pch = 19, phi = 15)
scatter3D(df$dim1, df$dim2, df$dim3, colvar = df$region,
pch = 19, phi = 75)
scatter3D(df$dim1, df$dim2, df$dim3, colvar = df$region,
pch = 19, phi = 65)
scatter3D(df$dim1, df$dim2, df$dim3, colvar = df$region,
pch = 19, phi = 55)
scatter3D(df$dim1, df$dim2, df$dim3, colvar = df$region,
pch = 19, phi = 30)
scatter3D(df$dim1, df$dim2, df$dim3, colvar = df$region,
pch = 19, phi = 20)
scatter3D(df$dim1, df$dim2, df$dim3, colvar = df$region,
pch = 19, phi = 15)
scatter3D(df$dim1, df$dim2, df$dim3, colvar = df$region,
pch = 19, phi = 0)
scatter3D(df$dim1, df$dim2, df$dim3, colvar = df$region,
pch = 19, phi = 10)
scatter3D(df$dim1, df$dim2, df$dim3, colvar = df$region,
pch = 19, phi = 12.5)
scatter3D(df$dim1, df$dim2, df$dim3, colvar = df$region,
pch = 19, phi = 15)
scatter3D(df$dim1, df$dim2, df$dim3, colvar = df$region,
pch = 19, phi = 20)
scatter3D(df$dim1, df$dim2, df$dim3, colvar = df$region,
pch = 19, phi = 20, theta = 0)
scatter3D(df$dim1, df$dim2, df$dim3, colvar = df$region,
pch = 19, phi = 20, theta = 30)
scatter3D(df$dim1, df$dim2, df$dim3, colvar = df$region,
pch = 19, phi = 20, theta = 60)
scatter3D(df$dim1, df$dim2, df$dim3, colvar = df$region,
pch = 19, phi = 20, theta = 90)
scatter3D(df$dim1, df$dim2, df$dim3, colvar = df$region,
pch = 19, phi = 20, theta = 180)
scatter3D(df$dim1, df$dim2, df$dim3, colvar = df$region,
pch = 19, phi = 20, theta = 360)
scatter3D(df$dim1, df$dim2, df$dim3, colvar = df$region,
pch = 19, phi = 20, theta = 0)
scatter3D(df$dim1, df$dim2, df$dim3, colvar = df$region,
pch = 19, phi = 20, theta = 0)
scatter3D(df$dim1, df$dim2, df$dim3, colvar = df$region,
pch = 19, phi = 20, theta = 45)
scatter3D(df$dim1, df$dim2, df$dim3, colvar = df$region,
pch = 19, phi = 20, theta = 35)
scatter3D(df$dim1, df$dim2, df$dim3, colvar = df$region,
pch = 19, phi = 20, theta = 25)
scatter3D(df$dim1, df$dim2, df$dim3, colvar = df$region,
pch = 19, phi = 20, theta = 15)
scatter3D(df$dim1, df$dim2, df$dim3, colvar = df$region,
pch = 19, phi = 20, theta = 20)
scatter3D(df$dim1, df$dim2, df$dim3, colvar = df$region,
pch = 19, phi = 30, theta = 20)
scatter3D(df$dim1, df$dim2, df$dim3, colvar = df$region,
pch = 19, phi = 30, theta = 15)
scatter3D(df$dim1, df$dim2, df$dim3, colvar = df$region,
pch = 19, phi = 30, theta = 25)
scatter3D(df$dim1, df$dim2, df$dim3, colvar = df$region,
pch = 19, phi = 30, theta = 30)
scatter3D(df$dim1, df$dim2, df$dim3, colvar = df$region,
pch = 19, phi = 10, theta = 30)
df %>%
ggplot(aes(x = dim1, y = dim2)) +
geom_jitter(aes(color = region), shape = 19)
scatter3D(df$dim1, df$dim2, df$dim3, colvar = df$region,
pch = 19, phi = 10, theta = 30)
df %>%
ggplot(aes(x = dim1, y = dim2)) +
geom_jitter(aes(color = region), shape = 19)
scatter3D(df$dim1, df$dim2, df$dim3, colvar = df$region,
pch = 19, phi = 10, theta = 30)
df %>%
ggplot(aes(x = dim2, y = dim3)) +
geom_jitter(aes(color = region), shape = 19)
df %>%
ggplot(aes(x = dim1, y = dim2)) +
geom_jitter(aes(color = factor(region)), shape = 19)
df %>%
ggplot(aes(x = dim2, y = dim3)) +
geom_jitter(aes(color = factor(region)), shape = 19)
df %>%
ggplot(aes(x = dim1, y = dim2)) +
geom_jitter(aes(color = factor(region)), shape = 19)
df %>%
ggplot(aes(x = dim2, y = dim3)) +
geom_jitter(aes(color = factor(region)), shape = 19)
df %>%
ggplot(aes(x = dim1, y = dim3)) +
geom_jitter(aes(color = factor(region)), shape = 19)
scatter3D(x = df$dim1,
y = df$dim2,
z = df$dim3, colvar = df$region,
pch = 19, phi = 10, theta = 30)
scatter3D(x = df$dim1,
y = df$dim2,
z = df$dim3, colvar = df$region,
pch = 19, phi = 10, theta = 65)
df %>%
ggplot(aes(x = dim2, y = dim3)) +
geom_jitter(aes(color = factor(region)), shape = 19)
scatter3D(x = df$dim1,
y = df$dim2,
z = df$dim3, colvar = df$region,
pch = 19, phi = 10, theta = 30)
scatter3D(x = df$dim1,
y = df$dim2,
z = df$dim3, colvar = df$region,
pch = 19, phi = 0, theta = 30)
scatter3D(x = df$dim1,
y = df$dim2,
z = df$dim3, colvar = df$region,
pch = 19, phi = 45, theta = 30)
scatter3D(x = df$dim1,
y = df$dim2,
z = df$dim3, colvar = df$region,
pch = 19, phi = 90, theta = 30)
scatter3D(x = df$dim1,
y = df$dim2,
z = df$dim3, colvar = df$region,
pch = 19, phi = 180, theta = 30)
scatter3D(x = df$dim1,
y = df$dim2,
z = df$dim3, colvar = df$region,
pch = 19, phi = 180, theta = 90)
scatter3D(x = df$dim1,
y = df$dim2,
z = df$dim3, colvar = df$region,
pch = 19, phi = 180, theta = 45)
scatter3D(x = df$dim1,
y = df$dim2,
z = df$dim3, colvar = df$region,
pch = 19, phi = 180, theta = 0)
scatter3D(x = df$dim1,
y = df$dim2,
z = df$dim3, colvar = df$region,
pch = 19, phi = 90, theta = 0)
scatter3D(x = df$dim1,
y = df$dim2,
z = df$dim3, colvar = df$region,
pch = 19, phi = 85, theta = 0)
scatter3D(x = df$dim1,
y = df$dim2,
z = df$dim3, colvar = df$region,
pch = 19, phi = 75, theta = 0)
scatter3D(x = df$dim1,
y = df$dim2,
z = df$dim3, colvar = df$region,
pch = 19, phi = 45, theta = 0)
scatter3D(x = df$dim1,
y = df$dim2,
z = df$dim3, colvar = df$region,
pch = 19, phi = 35, theta = 0)
scatter3D(x = df$dim1,
y = df$dim2,
z = df$dim3, colvar = df$region,
pch = 19, phi = 20, theta = 0)
scatter3D(x = df$dim1,
y = df$dim2,
z = df$dim3, colvar = df$region,
pch = 19, phi = 20, theta = 45)
scatter3D(x = df$dim1,
y = df$dim2,
z = df$dim3, colvar = df$region,
pch = 19, phi = 0, theta = 45)
scatter3D(x = df$dim1,
y = df$dim2,
z = df$dim3, colvar = df$region,
pch = 19, phi = 90, theta = 45)
scatter3D(x = df$dim1,
y = df$dim2,
z = df$dim3, colvar = df$region,
pch = 19, phi = -90, theta = 45)
scatter3D(x = df$dim1,
y = df$dim2,
z = df$dim3, colvar = df$region,
pch = 19, phi = 10, theta = 30)
df %>%
ggplot(aes(x = dim1, y = dim2)) +
geom_jitter(aes(color = factor(region)), shape = 19)
scatter3D(x = df$dim1,
y = df$dim2,
z = df$dim3, colvar = df$region,
pch = 19, phi = -90, theta = 45)
scatter3D(x = df$dim1,
y = df$dim2,
z = df$dim3, colvar = df$region,
pch = 19, phi = -45, theta = 45)
scatter3D(x = df$dim1,
y = df$dim2,
z = df$dim3, colvar = df$region,
pch = 19, phi = -80, theta = 45)
scatter3D(x = df$dim1,
y = df$dim2,
z = df$dim3, colvar = df$region,
pch = 19, phi = -90, theta = 45)
scatter3D(x = df$dim1,
y = df$dim2,
z = df$dim3, colvar = df$region,
pch = 19, phi = -90, theta = 0)
df %>%
ggplot(aes(x = dim1, y = dim2)) +
geom_jitter(aes(color = factor(region)), shape = 19)
scatter3D(x = df$dim1,
y = df$dim2,
z = df$dim3, colvar = df$region,
pch = 19, phi = -90, theta = 0)
scatter3D(x = df$dim1,
y = df$dim2,
z = df$dim3, colvar = df$region,
pch = 19, phi = 90, theta = 0)
scatter3D(x = df$dim1,
y = df$dim2,
z = df$dim3, colvar = df$region,
pch = 19, phi = 180, theta = 0)
scatter3D(x = df$dim1,
y = df$dim2,
z = df$dim3, colvar = df$region,
pch = 19, phi = -180, theta = 0)
scatter3D(x = df$dim1,
y = df$dim2,
z = df$dim3, colvar = df$region,
pch = 19, phi = 90, theta = 0)
scatter3D(x = df$dim1,
y = df$dim2,
z = df$dim3, colvar = df$region,
pch = 19, phi = -90, theta = 0)
df %>%
ggplot(aes(x = dim1, y = dim2)) +
geom_jitter(aes(color = factor(region)), shape = 19)
## Correlations between variables
cor <- cor(PcaVote)
ggcorrplot::ggcorrplot(PcaVote)
## Generate pca
pca <- PCA(PcaVote, scale.unit = T, graph = T)
## eig > 1 is good
eig <- get_eigenvalue(pca)
round(eig)
## Graph
df <- data.frame(riding = Data$riding_id,
region = as.numeric(factor(Data$region)),
dim1 = pca$ind$coord[,1],
dim2 = pca$ind$coord[,2],
dim3 = pca$ind$coord[,3])
scatter3D(x = df$dim1,
y = df$dim2,
z = df$dim3, colvar = df$region,
pch = 19)
scatter3D(x = df$dim1,
y = df$dim2,
z = df$dim3, colvar = df$region,
pch = 19, phi = 10, theta = 30)
scatter3D(x = df$dim1,
y = df$dim2,
z = df$dim3, colvar = df$region,
pch = 19, phi = 0, theta = 65)
scatter3D(x = df$dim1,
y = df$dim2,
z = df$dim3, colvar = df$region,
pch = 19, phi = 0, theta = 45)
scatter3D(x = df$dim1,
y = df$dim2,
z = df$dim3, colvar = df$region,
pch = 19, phi = 0, theta = 25)
scatter3D(x = df$dim1,
y = df$dim2,
z = df$dim3, colvar = df$region,
pch = 19, phi = 0, theta = 75)
df %>%
ggplot(aes(x = dim1, y = dim2)) +
geom_jitter(aes(color = factor(region)), shape = 19)
df %>%
ggplot(aes(x = dim2, y = dim3)) +
geom_jitter(aes(color = factor(region)), shape = 19)
df %>%
ggplot(aes(x = dim1, y = dim3)) +
geom_jitter(aes(color = factor(region)), shape = 19)
scatter3D(x = df$dim1,
y = df$dim2,
z = df$dim3, colvar = df$region,
pch = 19, phi = 0, theta = 75)
scatter3D(x = df$dim1,
y = df$dim2,
z = df$dim3, colvar = df$region,
pch = 19, phi = 0, theta = 55)
scatter3D(x = df$dim1,
y = df$dim2,
z = df$dim3, colvar = df$region,
pch = 19, phi = 0, theta = 35)
scatter3D(x = df$dim1,
y = df$dim2,
z = df$dim3, colvar = df$region,
pch = 19, phi = 0, theta = 15)
scatter3D(x = df$dim1,
y = df$dim2,
z = df$dim3, colvar = df$region,
pch = 19, phi = -75, theta = 15)
scatter3D(x = df$dim1,
y = df$dim2,
z = df$dim3, colvar = df$region,
pch = 19, phi = -75, theta = 45)
